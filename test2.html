<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Custom dat.GUI NumberController</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
    </style>
</head>
<body>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.7.7/dat.gui.min.js"></script>
    <script>
    // Extend NumberController to create a custom RangeController
dat.gui.RangeController = function(object, property, min, max, step) {
    dat.controllers.NumberController.call(this, object, property, min, max, step);

    var _this = this;

    this.__min = min;
    this.__max = max;
    this.__step = step;

    this.__input = document.createElement('div');
    this.__input.classList.add('slider');

    this.__minHandle = document.createElement('div');
    this.__maxHandle = document.createElement('div');
    this.__range = document.createElement('div');

    this.__minHandle.classList.add('handle', 'min-handle');
    this.__maxHandle.classList.add('handle', 'max-handle');
    this.__range.classList.add('range');

    this.__input.appendChild(this.__minHandle);
    this.__input.appendChild(this.__maxHandle);
    this.__input.appendChild(this.__range);

    this.domElement.appendChild(this.__input);

    this.updateDisplay();

    function onMouseDrag(e) {
        e.preventDefault();

        var rect = _this.__input.getBoundingClientRect();
        var x = (e.clientX - rect.left) / rect.width;

        x = Math.max(0, Math.min(x, 1));

        var value = _this.__min + (_this.__max - _this.__min) * x;
        value = Math.round(value / _this.__step) * _this.__step;

        if (e.target === _this.__minHandle) {
            _this.object[_this.property][0] = Math.min(value, _this.object[_this.property][1]);
        } else {
            _this.object[_this.property][1] = Math.max(value, _this.object[_this.property][0]);
        }

        _this.updateDisplay();
    }

    function onMouseUp() {
        document.removeEventListener('mousemove', onMouseDrag);
        document.removeEventListener('mouseup', onMouseUp);
    }

    this.__minHandle.addEventListener('mousedown', function(e) {
        document.addEventListener('mousemove', onMouseDrag);
        document.addEventListener('mouseup', onMouseUp);
    });

    this.__maxHandle.addEventListener('mousedown', function(e) {
        document.addEventListener('mousemove', onMouseDrag);
        document.addEventListener('mouseup', onMouseUp);
    });
};

dat.gui.RangeController.prototype = Object.create(dat.controllers.NumberController.prototype);

dat.gui.RangeController.prototype.updateDisplay = function() {
    var min = this.object[this.property][0];
    var max = this.object[this.property][1];

    var minPercentage = (min - this.__min) / (this.__max - this.__min) * 100;
    var maxPercentage = (max - this.__min) / (this.__max - this.__min) * 100;

    this.__minHandle.style.left = minPercentage + '%';
    this.__maxHandle.style.left = maxPercentage + '%';
    this.__range.style.left = minPercentage + '%';
    this.__range.style.width = (maxPercentage - minPercentage) + '%';

    return this;
};

// Extend dat.GUI to add the new controller
dat.GUI.prototype.addRange = function(object, property, min, max, step) {
    return this.add(new dat.gui.RangeController(object, property, min, max, step));
};

        // Step 3: Create a GUI and use the custom range controller
        const gui = new dat.GUI();
        const obj = { value: 50 };

        // Add the custom range slider
        gui.addRange(obj, 'value', 0, 100, 2,1);

        // Test object to update in real-time
        obj.value = 50;
    </script>
</body>
</html>
